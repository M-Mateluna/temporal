/* === Boot Lightbox igual que en tu ejercicio resuelto === */
(function bootLightbox() {
  // 1) Usar el padre si estamos en iframe (para que el modal se muestre por encima)
  var root = (window.parent && window.parent !== window) ? window.parent : window;

  // 2) Asegurar el markup del lightbox (la máscara y contenedor)
  if (typeof root.addLightboxMarkup === 'function') {
    root.addLightboxMarkup();
  } else if (typeof addLightboxMarkup === 'function') {
    addLightboxMarkup();
  }

  // 3) Asegurar el objeto controlador de la ventana modal: Accion.ventana
  if (!root.Accion) root.Accion = {};
  if (!root.Accion.ventana) {
    // IU viene de componente/mascara/iu.js
    try { root.Accion.ventana = new root.IU(); } catch(e) { /* si no existe IU aún, seguirá usando ShowInfo wrapper */ }
  }

  // 4) Asegurar una función ShowInfo disponible (wrapper a IU.ShowInfo)
  if (typeof root.ShowInfo !== 'function') {
    root.ShowInfo = function(iframe, alto, ancho) {
      if (!root.Accion || !root.Accion.ventana) {
        // si aún no existe, intenta crearla en caliente
        if (typeof root.IU === 'function') {
          root.Accion = root.Accion || {};
          root.Accion.ventana = new root.IU();
        } else {
          console.error('IU no está disponible para Lightbox');
          return;
        }
      }
      root.Accion.ventana.ShowInfo(iframe, alto, ancho);
    };
  }

  // 5) (Opcional) cerrar desde hijos
  if (typeof root.OcultarVentana !== 'function') {
    root.OcultarVentana = function(){ if (root.Accion && root.Accion.ventana) root.Accion.ventana.OcultarVentana(); };
  }
})();
