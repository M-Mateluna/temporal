<?php
<div style="padding:1rem 1.25rem;">
<h3 style="margin:0 0 12px 0;">Termino Contrato</h3>
<div style="margin-bottom:12px;">
<?php
$label_input = 'Ingrese Fecha de Término:';
$nom_fech = 'fecha_termino';
$nom_fech_disabled = 'F'; // habilitado, pero el componente por defecto es readonly
$val_fech = $hoy; // valor por defecto hoy
$btn_clear_fech = 'fecha_termino_btn';
$btn_clear_fech_disabled = 'F';
$classPrincipal = 'FORMULARIONECSS';
$classAdicional = '';
$btn_borrar_in = true; // botón borrar visible dentro
$fech_style = 'width:17em;height:21px;';
$cnf_to = $minimo; // mínimo: -1 mes
$cnf_hasta = $maximo; // máximo: +1 mes
include $POSICION."componente/calendario/componente_fechadd.php";
?>
</div>


<div style="text-align:center;margin-top:16px;">
<button type="button" onclick="guardarFecha()" style="height:34px;padding:0 16px;">Guardar</button>
</div>
</div>


<?php require_once($POSICION."formFoot.php"); ?>


<!-- Dependencias y MessageBox -->
<script type="text/javascript" src="<?=$POSICION;?>componente/messagebox/class.php?v=1"></script>
<script>
// Forzar no editable (por si el tema/estilos permiten escribir)
(function(){
var el = document.getElementById('fecha_termino');
if (el) { el.setAttribute('readonly', 'readonly'); }
})();


var MSGBOX = {
ventana: typeof IU_MSGBOX,
initialize: function(){ this.ventana = new IU_MSGBOX(); },
Abrir: function(conf){
this.ventana.titulo = conf.titulo || 'Aviso';
this.ventana.texto = '<center>' + (conf.texto || '') + '</center>';
this.ventana.botonera = conf.botonera || 1; // Aceptar
this.ventana.fnretorno = conf.fnretorno || 'MSGBOX.fnretorno';
this.ventana.url = '<?=$POSICION?>';
this.ventana.Messagebox();
},
fnretorno: function(resp){}
};
MSGBOX.initialize();


function guardarFecha(){
var v = (document.getElementById('fecha_termino')||{}).value || '';
if (!v.trim()){
MSGBOX.Abrir({
titulo: 'Obligatorio',
texto: 'El campo fecha es obligatorio',
botonera: 1,
fnretorno: 'cerrarObligatorio'
});
return;
}
// pasar valor al padre e inyectarlo en el input deshabilitado
if (parent && parent.document){
var tgt = parent.document.getElementById('fecha_ejercicio');
if (tgt){ tgt.value = v; }
}
// cerrar lightbox
if (parent && parent.Ajuste && parent.Ajuste.ventana){ parent.Ajuste.ventana.HideInfo(); }
}


function cerrarObligatorio(resp){
// Solo cerrar el MessageBox, mantener el lightbox abierto
MSGBOX.ventana.HideInfo();
}
</script>
